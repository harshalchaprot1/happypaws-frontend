<div class="form-container">
  <mat-card class="pet-form-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>{{ isEditMode ? 'edit' : 'add_circle' }}</mat-icon>
        {{ isEditMode ? 'Edit Pet' : 'Add New Pet' }}
      </mat-card-title>
      <mat-card-subtitle>
        {{ isEditMode ? 'Update pet information' : 'Register a new pet for adoption' }}
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div *ngIf="loading" class="loading-overlay">
        <mat-spinner></mat-spinner>
      </div>

      <form #petForm="ngForm" (ngSubmit)="onSubmit(petForm)" novalidate>
        <!-- Basic Information Section -->
        <div class="form-section">
          <h3 class="section-title">Basic Information</h3>
          
          <div class="form-row">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Pet Name</mat-label>
              <input matInput 
                     id="name" 
                     name="name" 
                     required 
                     minlength="2"
                     [(ngModel)]="pet.name"
                     placeholder="Enter pet's name">
              <mat-icon matPrefix>pets</mat-icon>
              <mat-error *ngIf="petForm.submitted && !pet.name">Name is required</mat-error>
            </mat-form-field>
          </div>

          <div class="form-row two-columns">
            <mat-form-field appearance="outline">
              <mat-label>Species</mat-label>
              <mat-select id="species" 
                          name="species" 
                          required 
                          [(ngModel)]="pet.species"
                          placeholder="Select species">
                <mat-option *ngFor="let species of speciesOptions" [value]="species">
                  {{ species }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>category</mat-icon>
              <mat-error>Species is required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Breed</mat-label>
              <input matInput 
                     id="breed" 
                     name="breed" 
                     [(ngModel)]="pet.breed"
                     placeholder="Enter breed">
              <mat-icon matPrefix>label</mat-icon>
            </mat-form-field>
          </div>

          <div class="form-row two-columns">
            <mat-form-field appearance="outline">
              <mat-label>Age (years)</mat-label>
              <input matInput 
                     type="number" 
                     id="age" 
                     name="age" 
                     min="0" 
                     required 
                     [(ngModel)]="pet.age"
                     placeholder="0">
              <mat-icon matPrefix>cake</mat-icon>
              <mat-error>Age is required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Gender</mat-label>
              <mat-select id="gender" 
                          name="gender" 
                          required 
                          [(ngModel)]="pet.gender"
                          placeholder="Select gender">
                <mat-option *ngFor="let option of genderOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>wc</mat-icon>
              <mat-error>Gender is required</mat-error>
            </mat-form-field>
          </div>
        </div>

        <!-- Description Section -->
        <div class="form-section">
          <h3 class="section-title">Description</h3>
          
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Pet Description</mat-label>
            <textarea matInput 
                      id="description" 
                      name="description" 
                      rows="5"
                      [(ngModel)]="pet.description"
                      placeholder="Describe the pet's personality, habits, special needs, etc."></textarea>
            <mat-icon matPrefix>description</mat-icon>
            <mat-hint>Share details that will help find the perfect home</mat-hint>
          </mat-form-field>
        </div>

        <!-- Image Section -->
        <div class="form-section">
          <h3 class="section-title">Photo</h3>
          
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Image URL</mat-label>
            <input matInput 
                   id="imageUrl" 
                   name="imageUrl" 
                   [(ngModel)]="pet.imageUrl"
                   (ngModelChange)="onImageUrlChange()"
                   placeholder="https://example.com/pet-photo.jpg">
            <mat-icon matPrefix>image</mat-icon>
            <mat-hint>Paste a direct link to the pet's photo</mat-hint>
          </mat-form-field>

          <div *ngIf="imagePreview" class="image-preview-container">
            <img [src]="imagePreview" 
                 alt="Pet preview" 
                 class="image-preview"
                 (error)="imagePreview = null">
          </div>
        </div>

        <!-- Status & Type Section -->
        <div class="form-section">
          <h3 class="section-title">Additional Information</h3>
          
          <div class="form-row two-columns">
            <mat-form-field appearance="outline">
              <mat-label>Type</mat-label>
              <input matInput 
                     id="type" 
                     name="type" 
                     [(ngModel)]="pet.type"
                     placeholder="e.g., Indoor, Outdoor">
              <mat-icon matPrefix>info</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Status</mat-label>
              <mat-select id="status" 
                          name="status" 
                          [(ngModel)]="pet.status"
                          placeholder="Select status">
                <mat-option *ngFor="let option of statusOptions" [value]="option.value">
                  {{ option.label }}
                </mat-option>
              </mat-select>
              <mat-icon matPrefix>check_circle</mat-icon>
            </mat-form-field>
          </div>
        </div>

        <!-- Action Buttons -->
        <mat-card-actions class="form-actions">
          <button mat-raised-button 
                  type="button" 
                  (click)="onCancel()"
                  [disabled]="loading">
            <mat-icon>close</mat-icon>
            Cancel
          </button>

          <button mat-raised-button 
                  type="button" 
                  color="warn"
                  (click)="onReset(petForm)"
                  [disabled]="loading || isEditMode">
            <mat-icon>refresh</mat-icon>
            Reset
          </button>

          <button mat-raised-button 
                  type="submit" 
                  color="primary"
                  [disabled]="petForm.invalid || loading">
            <mat-spinner *ngIf="loading" diameter="20"></mat-spinner>
            <mat-icon *ngIf="!loading">{{ isEditMode ? 'save' : 'add' }}</mat-icon>
            <span *ngIf="!loading">{{ isEditMode ? 'Update Pet' : 'Add Pet' }}</span>
          </button>
        </mat-card-actions>
      </form>
    </mat-card-content>
  </mat-card>
</div>
